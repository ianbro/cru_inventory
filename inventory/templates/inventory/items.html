{% extends 'inventory/site_base.html' %}

{% block title %}Items{% endblock title %}

{% load staticfiles %}
{% block css %}
{{ block.super }}
<link type="text/css" rel="stylesheet" href="{% static 'css/items.css' %}" />
{% endblock %}

{% block custom_javascript %}
{{ block.super }}
<script type="text/javascript">
  window.root_categories = {{ categories_json | safe }};
  window.csrf = "{% csrf_token %}";
</script>
<script type="text/javascript" src="{% static 'js/items.js' %}"></script>
{% endblock custom_javascript %}

{% block content %}

<div class="content">
    {% for root_category in categories_python %}
        <div class="list" id="list__container--items_in">
            <div class="list__header" id="header--{{ root_category.pk }}" category-id="{{ root_category.pk }}">
                <h3>Available: {{ root_category.name }}</h3>
                {% if item_amount_error %}
                <p>Sorry, not enough</p>
                {% endif %}
            </div>
            <div class="list__content" id="category--{{ root_category.pk }}">
                
            </div>
        </div>
    {% endfor %}
    
    <div class="list" id="list__container--items_out">
      <div class="list__header header_out">
          <h3>Your Items Out:</h3>
      </div>
      <div class="list__content content_out">
          {% for record in users_items_out %}
          <div class="list__element" id="item_out-{{ record.id }}">
              <h4 class="out_element__toggle" item-id="out_{{ record.id }}">{{ record.item.name }}</h4>
              <div class="out_element__details" id="item--out_{{ record.id }}">
                  <div>
                      <p class="item__desc">{{ record.item.description }}</p>
                      <p class="record__person">Checked out by: {{ record.person }}</p>
                      <p class="record__amount">Amount Out: {{ record.amount }}</p>
                  </div>
                  <div>
                      <button class="submit_checkin" value="{{ record.id }}">Checkin</button>
                      <button class="useup_item" value="{{ record.id }}">Use Up</button>
                  </div>
              </div>
          </div>
          <div class="seperator"></div>
          {% endfor %}
      </div>
    </div>
    
    {% if user.is_superuser %}
    <div class="list" id="list__container--items_all_out">
      <div class="list__header header_all_out">
          <h3>All Other Items Out:</h3>
      </div>
      <div class="list__content content_all_out">
          {% for record in all_items_out %}
          <div class="list__element" id="item_out-{{ record.id }}">
              <h4 class="out_element__toggle" item-id="out_{{ record.id }}">{{ record.item.name }}</h4>
              <div class="out_element__details" id="item--out_{{ record.id }}">
                  <div>
                      <p class="item__desc">{{ record.item.description }}</p>
                      <p class="record__person">Checked out by: {{ record.person }}</p>
                      <p class="record__date_out">On: {{ record.date_checked_out }}</p>
                      <p class="record__amount">Amount Out: {{ record.amount }}</p>
                  </div>
              </div>
          </div>
          <div class="seperator"></div>
          {% endfor %}
      </div>
    </div>
    {% endif %}
</div>
{% endblock content %}